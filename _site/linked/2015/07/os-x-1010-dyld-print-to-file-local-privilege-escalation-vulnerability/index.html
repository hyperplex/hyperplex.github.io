<!DOCTYPE html>
<html>
<head>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48711093-2', 'auto');
  ga('send', 'pageview');

</script>

  <meta charset="UTF-8">
  <title>OS X 10.10 DYLD_PRINT_TO_FILE Local Privilege Escalation Vulnerability</title>
  <meta name="viewport" content="width=device-width">


  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/css/style.css" rel="stylesheet" />
  <link href="/assets/css/colors-alt.css" rel="stylesheet" />
  <link rel="icon" type="image/png" href="/assets/favicon32.png">
  <link rel="icon" type="image/png" href="/assets/favicon16.png">
  
</head>

<body>



  <header id="header">
    <h1>
    <a href="/" title="Hyperplex: Home">
    <img src="/assets/hyper_logo.png" alt="Hyperplex" height="56">
    </a>
    </h1>
    <p>By Daniel Aditya Istyana</p>
  </header>



  <div id="page">



    <div id="sidebar">
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archive</a></li>
          <li><a href="/linked">Linked</a></li>  
          <li><a href="/about">About</a></li>
          <li><a href="http://twitter.com/adityadaniel">Twitter</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
        </ul>
      </nav>
    </div>



    <div id="content">
      <article class="post">

	
			<h1>
				<a href="https://www.sektioneins.de/en/blog/15-07-07-dyld_print_to_file_lpe.html"> OS X 10.10 DYLD_PRINT_TO_FILE Local Privilege Escalation Vulnerability</a> 
				<a class="anchor" href="/linked/2015/07/os-x-1010-dyld-print-to-file-local-privilege-escalation-vulnerability/"><i class="icon-right-big"></i></a>
			</h1>
		

	<div class="post-content"><p><a href="https://twitter.com/i0n1c">Stefan Esser</a>:</p>

<blockquote>
  <p>With the release of OS X 10.10 Apple added some new features to the dynamic linker dyld. One of these features is the new environment variable <strong>DYLD_PRINT_TO_FILE</strong> that enables error logging to an arbitrary file.[…]. When this variable was added the usual safeguards that are required when adding support for new environment variables to the dynamic linker have not been used. Therefore it is possible to use this new feature even with SUID root binaries. This is dangerous, because it allows to open or create arbitrary files owned by the root user anywhere in the file system. Furthermore the opened log file is never closed and therefore its file descriptor is leaked into processes spawned by SUID binaries. This means child processes of SUID root processes can write to arbitrary files owned by the root user anywhere in the filesystem. This allows for easy privilege escalation in OS X 10.10.x.</p>
</blockquote>

<p>Furthermore Esser explained that this isn’t patched on OS X 10.10.4 or the beta 10.10.5 but get fixed on OS X El Capitan. If you’re on OS X 10.10.4, Esser offer interim fix on <a href="https://github.com/sektioneins/SUIDGuard">Github</a> but since it isn’t official fix, install at your own risk.</p>
</div>

	<p class="meta"><span class="postdate">Jul 24, 2015</span></p>

</article>
    </div>
  </div>



  <footer id="footer">
    <p class="copyright">Copyright &copy; 2015 Hyperplex.
  </footer>



  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="/assets/js/jquery.mobilemenu.min.js"></script>

  <script>
    $(document).ready(function(){
      $('#sidebar nav ul').mobileMenu({'topOptionText': 'Menu', 'prependTo': '#sidebar nav'});
    });
  </script>


</body>
</html>