---
layout: post
title: OS X 10.10 DYLD_PRINT_TO_FILE Local Privilege Escalation Vulnerability
categories: ['linked']
tags: [security, apple, osx]
published: True
external-url: https://www.sektioneins.de/en/blog/15-07-07-dyld_print_to_file_lpe.html
date: 2015-07-24 08:39:41
---

[Stefan Esser](https://twitter.com/i0n1c): 

> With the release of OS X 10.10 Apple added some new features to the dynamic linker dyld. One of these features is the new environment variable **DYLD_PRINT_TO_FILE** that enables error logging to an arbitrary file.[...]. When this variable was added the usual safeguards that are required when adding support for new environment variables to the dynamic linker have not been used. Therefore it is possible to use this new feature even with SUID root binaries. This is dangerous, because it allows to open or create arbitrary files owned by the root user anywhere in the file system. Furthermore the opened log file is never closed and therefore its file descriptor is leaked into processes spawned by SUID binaries. This means child processes of SUID root processes can write to arbitrary files owned by the root user anywhere in the filesystem. This allows for easy privilege escalation in OS X 10.10.x.

Furthermore Esser explained that this isn't patched on OS X 10.10.4 or the beta 10.10.5 but get fixed on OS X El Capitan. If you're on OS X 10.10.4, Esser offer interim fix on [Github](https://github.com/sektioneins/SUIDGuard) but since it isn't official fix, install at your own risk.
